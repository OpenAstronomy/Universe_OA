<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Good start for the project | Universe OpenAstronomy</title>
<link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../../rss.xml">
<link rel="canonical" href="http://openastronomy.org/Universe_OA/posts/2024/05/20240527_1323_ahmedhosssam/">
<!--[if lt IE 9]><script src="../../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Ahmed Hossam">
<link rel="prev" href="../20240526_0702_kartikmandar/" title="Finally the env issue is resolved" type="text/html">
<link rel="next" href="../20240528_1120_kartikmandar/" title="First official day of GSOC" type="text/html">
<meta property="og:site_name" content="Universe OpenAstronomy">
<meta property="og:title" content="Good start for the project">
<meta property="og:url" content="http://openastronomy.org/Universe_OA/posts/2024/05/20240527_1323_ahmedhosssam/">
<meta property="og:description" content="First 2 weeks summarize:


This week I began working on refactoring hek.py functions.
I started by migrating the finished work in GSoC2023 to a new PR to start working on it.
My first contribution was">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2024-05-27T13:23:44+01:00">
<meta property="article:tag" content="SunPy">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-dark
bg-dark
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="../../../../">

            <span id="blog-title">Universe OpenAstronomy</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../../../archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="../../../../categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="../../../../rss.xml" class="nav-link">RSS feed</a>

                
            </li>
</ul>
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
            <style>
@media screen and (max-width: 600px) {
.table-done {
    visibility: hidden;
    clear: both;
    padding: 0px 300px;
    width: 50%;
    display: block;
  }
}
            </style>
<div class="sidebar" style="width:100%; max-width:100%; float:initial; margin:0px;"><ul>
<li>
                   <img src="https://cdn.rawgit.com/sunpy/sunpy-logo/master/generated/sunpy_icon.svg" height="16" width="16"><a href="https://dev.to/ahmedhosssam" data-toggle="tooltip" data-placement="top" title="2024-06-17 04:44:45+01:00">
                    Ahmed Hossam
                   </a>
                   <span class="table-done" style="float: right; padding-right:600px;"><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-05-27 - 2024-06-10">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-06-10 - 2024-06-24">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-06-24 - 2024-07-01">âŒ</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-07-01 - 2024-07-15">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2024-07-15 - 2024-07-29">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2024-07-29 - 2024-08-12">ğŸ”²</span></span>
                </li>
<li>
                   <img src="https://openastronomy.org/img/members/radis_ico.png" height="16" width="16"><a href="http://code29563.github.io" data-toggle="tooltip" data-placement="top" title="2024-06-30 00:00:00+01:00">
                    code29563
                   </a>
                   <span class="table-done" style="float: right; padding-right:600px;"><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-05-27 - 2024-06-10">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-06-10 - 2024-06-24">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-06-24 - 2024-07-01">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-07-01 - 2024-07-15">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2024-07-15 - 2024-07-29">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2024-07-29 - 2024-08-12">ğŸ”²</span></span>
                </li>
<li>
                   <img src="https://openastronomy.org/img/members/gnuastro.svg" height="16" width="16"><a href="https://deadspheroid.github.io" data-toggle="tooltip" data-placement="top" title="2024-06-22 20:45:00+01:00">
                    DeadSpheroid
                   </a>
                   <span class="table-done" style="float: right; padding-right:600px;"><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-05-27 - 2024-06-10">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-06-10 - 2024-06-24">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-06-24 - 2024-07-01">âŒ</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-07-01 - 2024-07-15">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2024-07-15 - 2024-07-29">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2024-07-29 - 2024-08-12">ğŸ”²</span></span>
                </li>
<li>
                   <img src="https://cdn.rawgit.com/sunpy/sunpy-logo/master/generated/sunpy_icon.svg" height="16" width="16"><a href="https://deus1704.vercel.app" data-toggle="tooltip" data-placement="top" title="2024-06-15 14:59:31+01:00" style="color:rgb(255,0,0)">
                    Deus1704
                   </a>
                   <span class="table-done" style="float: right; padding-right:600px;"><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-05-27 - 2024-06-10">âŒ</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-06-10 - 2024-06-24">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-06-24 - 2024-07-01">âŒ</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-07-01 - 2024-07-15">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2024-07-15 - 2024-07-29">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2024-07-29 - 2024-08-12">ğŸ”²</span></span>
                </li>
<li>
                   <img src="https://github.com/StingraySoftware.png?size=40" height="16" width="16"><a href="https://gsoc2024.kartikmandar.com" data-toggle="tooltip" data-placement="top" title="2024-06-28 17:34:00+01:00">
                    Kartik Mandar
                   </a>
                   <span class="table-done" style="float: right; padding-right:600px;"><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-05-27 - 2024-06-10">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-06-10 - 2024-06-24">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-06-24 - 2024-07-01">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-07-01 - 2024-07-15">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2024-07-15 - 2024-07-29">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2024-07-29 - 2024-08-12">ğŸ”²</span></span>
                </li>
<li>
                   <img src="https://github.com/fornax-navo.png?size=40" height="16" width="16"><a href="https://lucasmartingarciagsoc24openastronomy.blogspot.com" data-toggle="tooltip" data-placement="top" title="2024-06-23 23:31:00+01:00">
                    Lucas Martin Garcia
                   </a>
                   <span class="table-done" style="float: right; padding-right:600px;"><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-05-27 - 2024-06-10">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-06-10 - 2024-06-24">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-06-24 - 2024-07-01">âŒ</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-07-01 - 2024-07-15">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2024-07-15 - 2024-07-29">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2024-07-29 - 2024-08-12">ğŸ”²</span></span>
                </li>
<li>
                   <img src="https://cdn.rawgit.com/sunpy/sunpy-logo/master/generated/sunpy_icon.svg" height="16" width="16"><a href="https://medium.com/@manitsingh018" data-toggle="tooltip" data-placement="top" title="2024-06-23 08:21:59+01:00">
                    Manit Singh
                   </a>
                   <span class="table-done" style="float: right; padding-right:600px;"><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-05-27 - 2024-06-10">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-06-10 - 2024-06-24">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-06-24 - 2024-07-01">âŒ</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-07-01 - 2024-07-15">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2024-07-15 - 2024-07-29">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2024-07-29 - 2024-08-12">ğŸ”²</span></span>
                </li>
<li>
                   <img src="https://cdn.rawgit.com/sunpy/sunpy-logo/master/generated/sunpy_icon.svg" height="16" width="16"><a href="https://viciouseagle03.github.io" data-toggle="tooltip" data-placement="top" title="2024-06-23 07:19:36+01:00">
                    ViciousEagle03
                   </a>
                   <span class="table-done" style="float: right; padding-right:600px;"><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-05-27 - 2024-06-10">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-06-10 - 2024-06-24">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-06-24 - 2024-07-01">âŒ</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2024-07-01 - 2024-07-15">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2024-07-15 - 2024-07-29">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2024-07-29 - 2024-08-12">ğŸ”²</span></span>
                </li>
</ul></div>
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Good start for the project</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../../../authors/ahmed-hossam/">Ahmed Hossam</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2024-05-27T13:23:44+01:00" itemprop="datePublished" title="2024-05-27 13:23">2024-05-27 13:23</time></a>
            </p>
            

                    <p class="linkline"><a href="https://dev.to/ahmedhosssam/good-start-for-the-project-131n">Original site</a></p>
        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <h3>


<!-- TEASER_END -->
First 2 weeks summarize:
</h3>

<p>This week I began working on refactoring <code>hek.py</code> functions.<br>
I started by migrating the finished work in <a href="https://github.com/sunpy/sunpy/pull/7059">GSoC2023</a> to a new <a href="https://github.com/sunpy/sunpy/pull/7619">PR</a> to start working on it.<br>
My first contribution was creating <code>util.py</code> file to include all utility functions needed for <code>hek.py</code>, a lot of functions that was added in HEKClient at first didn't make sense to remain there.</p>

<p>Now the new <code>util.py</code> file includes:<br></p>

<div class="highlight js-code-highlight">
<pre class="highlight python"><code><span class="k">def</span> <span class="nf">parse_times</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">parse_values_to_quantities</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">parse_columns_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">attributes</span><span class="p">,</span> <span class="n">is_coord_prop</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">parse_unit</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">is_coord_prop</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">parse_chaincode</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_unit</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>

</code></pre>

</div>



<p><code>get_unit</code> has been simplified in terms of implementation and interface, this was the first version:<br></p>

<div class="highlight js-code-highlight">
<pre class="highlight python"><code>    <span class="k">def</span> <span class="nf">get_unit</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="k">if</span> <span class="n">attribute</span><span class="p">[</span><span class="sh">"</span><span class="s">is_coord_prop</span><span class="sh">"</span><span class="p">]:</span>
<span class="n">coord1_unit</span><span class="p">,</span> <span class="n">coord2_unit</span><span class="p">,</span> <span class="n">coord3_unit</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
<span class="n">coord_units</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">[, ]</span><span class="sh">'</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
<span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">coord_units</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># deg
</span>               <span class="n">coord1_unit</span> <span class="o">=</span> <span class="n">coord2_unit</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="nc">Unit</span><span class="p">(</span><span class="n">coord_units</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">elif</span> <span class="nf">len</span><span class="p">(</span><span class="n">coord_units</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<span class="n">coord1_unit</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="nc">Unit</span><span class="p">(</span><span class="n">coord_units</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">coord2_unit</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="nc">Unit</span><span class="p">(</span><span class="n">coord_units</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
<span class="n">coord1_unit</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="nc">Unit</span><span class="p">(</span><span class="n">coord_units</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">coord2_unit</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="nc">Unit</span><span class="p">(</span><span class="n">coord_units</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">coord3_unit</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="nc">Unit</span><span class="p">(</span><span class="n">coord_units</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="k">return</span> <span class="nf">locals</span><span class="p">()[</span><span class="n">attribute</span><span class="p">[</span><span class="sh">"</span><span class="s">unit_prop</span><span class="sh">"</span><span class="p">]]</span>
<span class="k">else</span><span class="p">:</span>
<span class="k">return</span> <span class="n">u</span><span class="p">.</span><span class="nc">Unit</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</code></pre>

</div>



<p>The first thing that has been done is to use unit aliases inside the function using context manager instead of putting the aliases globally.</p>

<p>The whole goal of this function is to parse a string into an astropy unit, but the big part of the function was splitting the string into more than one unit if the input was coordinate units, and then returning the unit assigned to <code>unit_prop</code>. I decided to just remove all of this and convert the unit into an array and return the first index, like this:<br></p>

<div class="highlight js-code-highlight">
<pre class="highlight python"><code>   <span class="n">units</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">[, ]</span><span class="sh">'</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
<span class="k">return</span> <span class="n">u</span><span class="p">.</span><span class="nc">Unit</span><span class="p">(</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">lower</span><span class="p">())</span>
</code></pre>

</div>



<p>And actually it works just fine with all HEK features and events, so I will keep it like this until some strange error appears.<br>
And also the interface has been simplified to just take the string of the targeted unit.</p>

<p>This is the current version of <code>get_unit</code>:<br></p>

<div class="highlight js-code-highlight">
<pre class="highlight python"><code><span class="k">def</span> <span class="nf">get_unit</span><span class="p">(</span><span class="n">unit</span><span class="p">):</span>
<span class="sh">"""</span><span class="s">
Converts string into astropy unit.

Parameters
----------
unit: str
The targeted unit

Returns
-------
unit
Astropy unit object (e.g. &lt;class </span><span class="sh">'</span><span class="s">astropy.units.core.Unit</span><span class="sh">'</span><span class="s">&gt; or &lt;class </span><span class="sh">'</span><span class="s">astropy.units.core.CompositeUnit</span><span class="sh">'</span><span class="s">&gt;)

Raises
------
ValueError
Because `unit` did not parse as unit.

Notes
----
For the complete list of HEK parameters: https://www.lmsal.com/hek/VOEvent_Spec.html

</span><span class="sh">"""</span>
<span class="n">cm2</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="nf">def_unit</span><span class="p">(</span><span class="sh">"</span><span class="s">cm2</span><span class="sh">"</span><span class="p">,</span> <span class="n">u</span><span class="p">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="n">m2</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="nf">def_unit</span><span class="p">(</span><span class="sh">"</span><span class="s">m2</span><span class="sh">"</span><span class="p">,</span> <span class="n">u</span><span class="p">.</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">m3</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="nf">def_unit</span><span class="p">(</span><span class="sh">"</span><span class="s">m3</span><span class="sh">"</span><span class="p">,</span> <span class="n">u</span><span class="p">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>

<span class="n">aliases</span> <span class="o">=</span> <span class="p">{</span>
<span class="sh">"</span><span class="s">steradian</span><span class="sh">"</span><span class="p">:</span> <span class="n">u</span><span class="p">.</span><span class="n">sr</span><span class="p">,</span>
<span class="sh">"</span><span class="s">arcseconds</span><span class="sh">"</span><span class="p">:</span> <span class="n">u</span><span class="p">.</span><span class="n">arcsec</span><span class="p">,</span>
<span class="sh">"</span><span class="s">degrees</span><span class="sh">"</span><span class="p">:</span> <span class="n">u</span><span class="p">.</span><span class="n">deg</span><span class="p">,</span>
<span class="sh">"</span><span class="s">sec</span><span class="sh">"</span><span class="p">:</span> <span class="n">u</span><span class="p">.</span><span class="n">s</span><span class="p">,</span>
<span class="sh">"</span><span class="s">emx</span><span class="sh">"</span><span class="p">:</span> <span class="n">u</span><span class="p">.</span><span class="n">Mx</span><span class="p">,</span>
<span class="sh">"</span><span class="s">amperes</span><span class="sh">"</span><span class="p">:</span> <span class="n">u</span><span class="p">.</span><span class="n">A</span><span class="p">,</span>
<span class="sh">"</span><span class="s">ergs</span><span class="sh">"</span><span class="p">:</span> <span class="n">u</span><span class="p">.</span><span class="n">erg</span><span class="p">,</span>
<span class="sh">"</span><span class="s">cubic centimeter</span><span class="sh">"</span><span class="p">:</span> <span class="n">u</span><span class="p">.</span><span class="n">ml</span><span class="p">,</span>
<span class="sh">"</span><span class="s">square centimeter</span><span class="sh">"</span><span class="p">:</span> <span class="n">cm2</span><span class="p">,</span>
<span class="sh">"</span><span class="s">cubic meter</span><span class="sh">"</span><span class="p">:</span> <span class="n">m3</span><span class="p">,</span>
<span class="sh">"</span><span class="s">square meter</span><span class="sh">"</span><span class="p">:</span> <span class="n">m2</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">with</span> <span class="n">u</span><span class="p">.</span><span class="nf">add_enabled_units</span><span class="p">([</span><span class="n">cm2</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">m3</span><span class="p">]),</span> <span class="n">u</span><span class="p">.</span><span class="nf">set_enabled_aliases</span><span class="p">(</span><span class="n">aliases</span><span class="p">):</span>
<span class="c1"># If they are units of coordinates, it will have more than one unit,
</span>        <span class="c1"># otherwise it will be just one unit.
</span>        <span class="c1"># NOTE: There is an assumption that coord1_unit, coord2_unit and coord3_unit will be the same.
</span>        <span class="n">units</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">[, ]</span><span class="sh">'</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
<span class="k">return</span> <span class="n">u</span><span class="p">.</span><span class="nc">Unit</span><span class="p">(</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">lower</span><span class="p">())</span>

</code></pre>

</div>



<p>Another thing that has been done was adding a documentation string for <code>parse_chaincode</code> function.<br></p>

<div class="highlight js-code-highlight">
<pre class="highlight python"><code><span class="k">def</span> <span class="nf">parse_chaincode</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
<span class="sh">"""</span><span class="s">
Parses a string representation of coordinates and convert them into a PolygonSkyRegion object
using units based on the specified coordinate frame.

Parameters
----------
value: PolygonSkyRegion
A polygon defined using vertices in sky coordinates.
attribute: dict
An object from coord_properties.json
unit: str
The unit of the coordinates

Returns
-------
PolygonSkyRegion
A polygon defined using vertices in sky coordinates.

Raises
------
IndexError
Because `value` does not contain the expected </span><span class="sh">'</span><span class="s">((</span><span class="sh">'</span><span class="s"> and </span><span class="sh">'</span><span class="s">))</span><span class="sh">'</span><span class="s"> substrings.
UnitConversionError
Because the units set by `coord1_unit` or `coord2_unit` are incompatible with the values being assigned.

</span><span class="sh">"""</span>
<span class="n">coord1_unit</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="n">deg</span>
<span class="n">coord2_unit</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="n">deg</span>
<span class="k">if</span> <span class="n">attribute</span><span class="p">[</span><span class="sh">"</span><span class="s">frame</span><span class="sh">"</span><span class="p">]</span> <span class="o">==</span> <span class="sh">"</span><span class="s">helioprojective</span><span class="sh">"</span><span class="p">:</span>
<span class="n">coord1_unit</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="n">arcsec</span>
<span class="n">coord2_unit</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="n">arcsec</span>
<span class="k">elif</span> <span class="n">attribute</span><span class="p">[</span><span class="sh">"</span><span class="s">frame</span><span class="sh">"</span><span class="p">]</span> <span class="o">==</span> <span class="sh">"</span><span class="s">heliocentric</span><span class="sh">"</span><span class="p">:</span>
<span class="n">coord1_unit</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="n">R_sun</span> <span class="c1"># Nominal solar radius
</span>    <span class="k">elif</span> <span class="n">attribute</span><span class="p">[</span><span class="sh">"</span><span class="s">frame</span><span class="sh">"</span><span class="p">]</span> <span class="o">==</span> <span class="sh">"</span><span class="s">icrs</span><span class="sh">"</span><span class="p">:</span>
<span class="n">coord1_unit</span> <span class="o">=</span> <span class="nf">get_unit</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
<span class="n">coord2_unit</span> <span class="o">=</span> <span class="nf">get_unit</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>

<span class="n">coordinates_str</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">((</span><span class="sh">'</span><span class="p">)[</span><span class="mi">1</span><span class="p">].</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">))</span><span class="sh">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">coord1_list</span> <span class="o">=</span> <span class="p">[</span><span class="nf">float</span><span class="p">(</span><span class="n">coord</span><span class="p">.</span><span class="nf">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coordinates_str</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">,</span><span class="sh">'</span><span class="p">)]</span> <span class="o">*</span> <span class="n">coord1_unit</span>
<span class="n">coord2_list</span> <span class="o">=</span> <span class="p">[</span><span class="nf">float</span><span class="p">(</span><span class="n">coord</span><span class="p">.</span><span class="nf">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coordinates_str</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">,</span><span class="sh">'</span><span class="p">)]</span> <span class="o">*</span> <span class="n">coord2_unit</span>
<span class="n">vertices</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">if</span> <span class="n">attribute</span><span class="p">[</span><span class="sh">"</span><span class="s">frame</span><span class="sh">"</span><span class="p">]</span> <span class="o">==</span> <span class="sh">"</span><span class="s">heliocentric</span><span class="sh">"</span><span class="p">:</span>
<span class="n">vertices</span> <span class="o">=</span> <span class="nc">SkyCoord</span><span class="p">(</span><span class="n">coord1_list</span><span class="p">,</span> <span class="n">coord2_list</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span> <span class="nf">len</span><span class="p">(</span><span class="n">coord1_list</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="p">.</span><span class="n">AU</span><span class="p">,</span> <span class="n">representation_type</span><span class="o">=</span><span class="sh">"</span><span class="s">cylindrical</span><span class="sh">"</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="sh">"</span><span class="s">heliocentric</span><span class="sh">"</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
<span class="n">vertices</span> <span class="o">=</span> <span class="nc">SkyCoord</span><span class="p">(</span><span class="n">coord1_list</span><span class="p">,</span> <span class="n">coord2_list</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">attribute</span><span class="p">[</span><span class="sh">"</span><span class="s">frame</span><span class="sh">"</span><span class="p">])</span>

<span class="k">return</span> <span class="nc">PolygonSkyRegion</span><span class="p">(</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">)</span>
</code></pre>

</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../../categories/sunpy/" rel="tag">SunPy</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../20240526_0702_kartikmandar/" rel="prev" title="Finally the env issue is resolved">Previous post</a>
            </li>
            <li class="next">
                <a href="../20240528_1120_kartikmandar/" rel="next" title="First official day of GSOC">Next post</a>
            </li>
        </ul></nav></aside></article><!--End of body content--><footer id="footer">
            Contents Â© 2024         <a href="mailto:openastronomy@openastronomy.com">OpenAstronomy</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">
<img alt="Creative Commons License BY-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>
            
            
        </footer>
</div>
</div>


        <script src="../../../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
