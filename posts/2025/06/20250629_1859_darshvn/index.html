<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Things Are Starting to Come Together | Universe OpenAstronomy</title>
<link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../../rss.xml">
<link rel="canonical" href="http://openastronomy.org/Universe_OA/posts/2025/06/20250629_1859_darshvn/">
<!--[if lt IE 9]><script src="../../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Darshan Patil">
<link rel="prev" href="../20250629_0626_kashish2210/" title="âœ¨Good Time, Bad Time: GTI/BTI :)" type="text/html">
<meta property="og:site_name" content="Universe OpenAstronomy">
<meta property="og:title" content="Things Are Starting to Come Together">
<meta property="og:url" content="http://openastronomy.org/Universe_OA/posts/2025/06/20250629_1859_darshvn/">
<meta property="og:description" content="The past couple of weeks have been really productive. After the initial planning and community bonding period, Iâ€™ve finally started working on the actual implementation. The transition from understand">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2025-06-29T18:59:01+01:00">
<meta property="article:tag" content="radis">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-dark
bg-dark
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="../../../../">

            <span id="blog-title">Universe OpenAstronomy</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../../../archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="../../../../categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="../../../../rss.xml" class="nav-link">RSS feed</a>

                
            </li>
</ul>
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
            <style>
@media screen and (max-width: 600px) {
.table-done {
    visibility: hidden;
    clear: both;
    padding: 0px 300px;
    width: 50%;
    display: block;
  }
}
            </style>
<div class="sidebar" style="width:100%; max-width:100%; float:initial; margin:0px;"><ul>
<li>
                   <img src="https://openastronomy.org/img/members/radis_ico.png" height="16" width="16"><a href="https://medium.com/@darshvn" data-toggle="tooltip" data-placement="top" title="2025-06-29 18:59:01+01:00">
                    Darshan Patil
                   </a>
                   <span class="table-done" style="float: right; padding-right:600px;"><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-05-01 - 2025-06-02">âŒ</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-06-02 - 2025-06-16">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-06-16 - 2025-06-30">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-06-30 - 2025-07-14">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2025-07-14 - 2025-07-28">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2025-07-28 - 2025-08-11">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2025-08-11 - 2025-08-25">ğŸ”²</span></span>
                </li>
<li>
                   <img src="https://github.com/juliaastro.png?size=40" height="16" width="16"><a href="https://kashish2210.blogspot.com" data-toggle="tooltip" data-placement="top" title="2025-06-29 06:26:00+01:00">
                    kashish shrivastav
                   </a>
                   <span class="table-done" style="float: right; padding-right:600px;"><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-05-01 - 2025-06-02">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-06-02 - 2025-06-16">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-06-16 - 2025-06-30">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-06-30 - 2025-07-14">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2025-07-14 - 2025-07-28">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2025-07-28 - 2025-08-11">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2025-08-11 - 2025-08-25">ğŸ”²</span></span>
                </li>
<li>
                   <img src="https://github.com/StingraySoftware.png?size=40" height="16" width="16"><a href="https://sejifukishima.blogspot.com" data-toggle="tooltip" data-placement="top" title="2025-06-04 18:03:00+01:00" style="color:rgb(255,0,0)">
                    Mohammad Adnan
                   </a>
                   <span class="table-done" style="float: right; padding-right:600px;"><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-05-01 - 2025-06-02">âŒ</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-06-02 - 2025-06-16">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-06-16 - 2025-06-30">âŒ</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-06-30 - 2025-07-14">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2025-07-14 - 2025-07-28">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2025-07-28 - 2025-08-11">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2025-08-11 - 2025-08-25">ğŸ”²</span></span>
                </li>
<li>
                   <img src="https://openastronomy.org/img/members/radis_ico.png" height="16" width="16"><a href="https://medium.com/@mohyware" data-toggle="tooltip" data-placement="top" title="2025-06-20 05:05:37+01:00">
                    mohyware
                   </a>
                   <span class="table-done" style="float: right; padding-right:600px;"><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-05-01 - 2025-06-02">âŒ</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-06-02 - 2025-06-16">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-06-16 - 2025-06-30">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-06-30 - 2025-07-14">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2025-07-14 - 2025-07-28">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2025-07-28 - 2025-08-11">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2025-08-11 - 2025-08-25">ğŸ”²</span></span>
                </li>
<li>
                   <img src="https://openastronomy.org/img/members/radis_ico.png" height="16" width="16"><a href="https://medium.com/@prathamhole" data-toggle="tooltip" data-placement="top" title="2025-06-07 09:49:18+01:00" style="color:rgb(255,0,0)">
                    Pratham
                   </a>
                   <span class="table-done" style="float: right; padding-right:600px;"><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-05-01 - 2025-06-02">âŒ</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-06-02 - 2025-06-16">âœ…</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-06-16 - 2025-06-30">âŒ</span><span style="display:table-cell; width:7%;" data-toggle="tooltip" title="2025-06-30 - 2025-07-14">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2025-07-14 - 2025-07-28">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2025-07-28 - 2025-08-11">ğŸ”²</span><span style="display:table-cell; width:7%;opacity: 0.5;" data-toggle="tooltip" title="2025-08-11 - 2025-08-25">ğŸ”²</span></span>
                </li>
</ul></div>
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Things Are Starting to Come Together</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../../../authors/darshan-patil/">Darshan Patil</a>
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2025-06-29T18:59:01+01:00" itemprop="datePublished" title="2025-06-29 18:59">2025-06-29 18:59</time></a>
            </p>
            

                    <p class="linkline"><a href="https://medium.com/@darshvn/things-are-starting-to-come-together-388f0918afc5?source=rss-33c64fc8aea8------2">Original site</a></p>
        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>The past couple of weeks have been really productive. After the initial planning and community bonding period, Iâ€™ve finally started working on the actual implementation. The transition from understanding the theory to getting hands-on with the code has been challenging but rewarding.</p>
<p>After writing my last blog post and going through the codebase more thoroughly, I discovered there are several existing classes and methods that can be reused for this project. This has led to a revised approach that builds on whatâ€™s already working well inÂ RADIS.</p>
<h4>Revised Approach</h4>
<figure><img alt="" src="https://cdn-images-1.medium.com/max/876/1*XSL9jIwlwb7FZpoD5oZjEg.png"></figure><p>The core approach is the same as originally planned, but now the rovibrational populations are calculated using the existing RovibParFuncCalculator. This lets me reuse code while adding the electronic state functionality weÂ need.</p>
<!-- TEASER_END -->
<p>The workflow starts with user inputs: electronic temperature (Telec), rotational temperature (Trot), and optional manual band scaling. The system processes the main electronic states OH(X) and OH(A) for now only works with hydroxyl radical calculations.</p>
<p>The ElectronicPartitionFunction computes population fractions for each electronic state at the specified electronic temperature. Meanwhile, the RovibParFuncCalculator handles rovibrational populations for each state at the rotational temperature. These calculations run in parallel, and their results get multiplied to determine total populations for each rovibrational level within each electronic state.</p>
<p>After applying any manual band scaling factors, all contributions from the various electronic states are summed to build the complete spectrum.</p>
<h4>The Mathematical Foundation</h4>
<p>The calculation relies on determining the total population of a rovibrational levelÂ using:</p>
<figure><img alt="" src="https://cdn-images-1.medium.com/max/991/1*95PzSSkP9W6DyHOTonDx4A.png"></figure><p>This separates cleanly into electronic and rovibrational components. The electronic part depends on degeneracy and energy at the electronic temperature, while the rovibrational part accounts for vibrational and rotational contributions at the rovibrational temperature.</p>
<p>The partition functions are calculated separately: Z_elec for electronic states and Z_rovib for rovibrational states. For practical purposes, these can be treated as separable components, which simplifies the implementation considerably.</p>
<h4>Working with ExoMolÂ Data</h4>
<p>Working with ExoMolâ€™sÂ .states files has been interesting. These files contain detailed molecular energy level information, but parsing them correctly for electronic transitions requires careful attention to the quantum mechanics involved.</p>
<p>Weâ€™ve adapted the existing read_states functionality in RADIS to handle all the columns we need for this project. The standard format includes columns for [n, E, g, J, e/f, v, F1/F2, State], where each parameter is important for determining molecular behavior. By extending the existing parsing capabilities, we can now properly extract and interpret these electronic quantum numbers for use in subsequent calculations.</p>
<h4>Electronic StateÂ Mapping</h4>
<p>Iâ€™ve implemented functions to map electronic states and calculate proper degeneracies, which are essential for accurate partition function calculations. This mapping system ensures each quantum state is properly characterized with its corresponding statistical weight andÂ energy.</p>
<p>The mapping process involves parsing quantum state labels from ExoMol files and translating them into RADISâ€™s internal representation. This maintains the physical meaning while adapting to RADISâ€™s computational framework.</p>
<h4>Architecture Design</h4>
<p>One of the more interesting technical challenges has been designing the partition function architecture for electronic states. Iâ€™ve been working with the existing RovibParFuncCalculator in radis/levels/partfunc.py, which handles rovibrational partition functions effectively.</p>
<p>The architecture centers on separating electronic partition function calculations into dedicated components while maintaining integration with existing functionality. The ElectronicPartitionFunction class handles electronic state calculations, managing the quantum mechanical relationships and temperature dependencies for electronic population distributions.</p>
<p>This integrates with existing rovibrational calculations and allows users to specify different electronic temperatures (Telec) independently from rovibrational temperatures. This separation makes physical sense since electronic excitation often occurs under different conditions than rovibrational excitation.</p>
<p>The system also includes manual band intensity adjustment capabilities, giving researchers flexibility to fine-tune calculations based on experimental observations or theoretical corrections that might not be fully captured in the base calculations.</p>
<h4>Current Implementation Status</h4>
<p>The implementation is progressing well. ExoMol parsing now properly handles electronic state information, and band scaling functionality works with dictionary-based inputÂ formats.</p>
<p>The ElectronicPartitionFunction class computes population fractions for individual electronic states at specified temperatures. The enhanced RovibParFuncCalculator handles rovibrational populations across multiple electronic states. Integration multiplies electronic fractions by rovibrational populations to get total level populations, and final spectrum synthesis sums contributions from all electronic states.</p>
<h4>Next Steps</h4>
<p>The next phase will focus on fixing the broken control and data flow, optimization, testing with various molecular systems, and ensuring robust performance across the range of conditions RADIS users encounter.</p>
<img alt="" height="1" src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=388f0918afc5" width="1">
</div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../../categories/radis/" rel="tag">radis</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../20250629_0626_kashish2210/" rel="prev" title="âœ¨Good Time, Bad Time: GTI/BTI :)">Previous post</a>
            </li>
        </ul></nav></aside></article><!--End of body content--><footer id="footer">
            Contents Â© 2025         <a href="mailto:openastronomy@openastronomy.com">OpenAstronomy</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">
<img alt="Creative Commons License BY-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>
            
            
        </footer>
</div>
</div>


        <script src="../../../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
